{{ $image := partial "helper/image" (dict "Image" .context.Params.image "Resources" .context.Resources) }}
<article class="{{ if $image }}has-image{{ end }}">
    <a href="{{ .context.RelPermalink }}">
        {{ if $image }}
        <div class="article-image">
            {{ if eq .Type "articleList" }}
                <img src="{{ $image.Permalink }}" width="{{ $image.Width }}" height="{{ $image.Height }}" loading="lazy" alt="Featured image of post {{ .context.Title }}">
            {{ else }}
                {{ partial "helper/responsive-image" (dict
                    "Page" .context
                    "Image" .context.Params.image
                    "Alt" (printf "Featured image of post %s" .context.Title)
                    "Sizes" "(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 640px"
                ) }}
            {{ end }}
        </div>
        {{ end }}

        <div class="article-details"
            {{- if and $image $image.Resource -}}
                {{- $colors := $image.Resource.Colors -}}
                {{- if $colors -}}
                    {{- $vibrant := index $colors 0 -}}
                    {{- $darkMuted := index $colors 1 | default $vibrant -}}
                    style="background: linear-gradient(0deg, {{ $darkMuted }}80 0%, {{ $vibrant }}C0 100%);"
                {{- end -}}
            {{- end -}}
        >
            <h2 class="article-title">
                {{- .context.Title -}}
            </h2>
        </div>
    </a>
</article>
